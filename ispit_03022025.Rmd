---
title: "ispit_03022025"
output: html_notebook
---

# Exercise 1

Тимот за аналитика во еден ланец златари коишто откупуваат злато, на случаен начин избрал 35 различни седмици и сака да спроведе анализа за масата (изразена во милиграма) откупено злато во текот на една седмица од страна на ланецот златари. Резултатите се следните: 120, 125, 130, 110, 115, 140, 135, 128, 122, 118, 132, 140, 138, 121, 133, 130, 126, 127, 129, 119, 136, 125, 123, 131, 124, 137, 139, 120, 128, 132, 125, 100, 101, 102, 103 Од овие податоци, пресметајте 95% интервал на доверба на дисперзијата на масата злато што го откупува ланецот златари во текот на една седмица. Познато е дека масата злато што го откупува ланецот златари во текот на една седмица има нормална распределба.

## Solution

```{r}
x <- c(120, 125, 130, 110, 115, 140, 135, 128, 122, 118, 132, 140, 138, 121, 133, 130, 126, 127,129, 119, 136, 125, 123, 131, 124, 137, 139, 120, 128, 132, 125, 100, 101, 102, 103)
alpha <- 0.05
var(x)
var.conf.int <- function(x) {
  lower <- (length(x) - 1) * var(x) / qchisq(alpha/2, df = (length(x) - 1), lower.tail = FALSE)
  upper <- (length(x) -1) * var(x) / qchisq(1 - alpha /2, df = (length(x) - 1), lower.tail = FALSE)
  return (c(lower, upper))
}
var.conf.int(x)
```

# Exercise 2

Тимот за аналититка во еден ланец златари коишто откупуваат злато, на случаен начин избрал 35 различни седмици и сака да спроведе анализа за масата (изразена во мг) откупено злато во текот на една седмица од страна на ланецот златари се зголемил после маркетинг кампањата што ја спровеле во текот на овие седмици. Познато е дека масата откупено злато има нормална распеделба. Резултатите се следните: 120, 125, 130, 110, 115, 140, 135, 128, 122, 118, 132, 140, 138, 121, 133, 130, 126, 127, 129, 119, 136, 125, 123, 131, 124, 137, 139, 120, 128, 132, 125, 100, 101, 102, 103 Очекуваната маса откупено злато во текот на една недела пред маркетинг камањата била 95мг. Користејќи ги прибраните податоци, со ниво на значајност 0.05, да се тестира дали очекуваната маса откупено злато во текот на една седмица се зголемила, поради маркетинг кампањата.

## Solution

$$
H_0: \mu = 95,
$$

$$
H_a: \mu > 95
$$

```{r}
x <- c(120, 125, 130, 110, 115, 140, 135, 128, 122, 118, 132, 140, 138, 121, 133, 130, 126, 127, 129, 119, 136, 125, 123, 131, 124, 137, 139, 120, 128, 132, 125, 100, 101, 102, 103)
library("BSDA")
alpha <- 0.05 
result <- z.test(x, alternative = "greater", mu = 95, conf.level = 1 - alpha, sigma.x = sd(x))
alpha < result$p.value
# the p-value is less than alpha -> H_0 is rejected, i.e. the expected gold mass is larger after one campaign
```

# Exercise 3

## Solution

$$
H_0: X has Geo(0.3),
$$

$$
H_a: X!Geo(0.3)
$$

```{r}
alpha <- 0.05
p0 <- pgeom(1, 0.3) # CDF
p1 <- dgeom(2, 0.3) # PMF
p2 <- dgeom(3, 0.3) # PMF
p3 <- 1 - (p0 + p1 + p2) # 1 - CDF <= 5

freqs <- c(20, 45, 20, 15)
probs <- c(p0, p1, p2, p3)
probs
res <- chisq.test(freqs, p=probs)
alpha < res$p.value

```

# Exercise 4

# Exercise 5

## Solution

```{r}
x <- c(743, 751, 748, 757, 752, 745, 750, 755, 749, 754, 742, 756, 744, 753, 746)
dis <- 4
alpha <- 0.05
chi_sq <- ((length(x) - 1) * var(x)) / dis
b <- qchisq(alpha, length(x) - 1, lower.tail = FALSE)
b
chi_sq < b
```

# Exercise 6

```{r}
```
